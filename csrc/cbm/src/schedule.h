#include <vector>
#include <stdexcept>

static std::vector<std::vector<std::vector<int>>> schedules = {
    {
        {2, 4096, 1, 1, 0}
    },
    {
        {2, 4096, 1, 1, 0}
    },
    {
        {2, 4096, 1, 1, 0}
    },
    {
        {2, 4096, 1, 1, 0}
    },
    {
        {2, 8192, 1, 4096, 0},
        {8192, 8192, 4096, 2048, 1},
        {8192, 8192, 2048, 1, 0}
    },
    {
        {2, 8192, 1, 1, 0}
    },
    {
        {2, 8192, 1, 1, 0}
    },
    {
        {2, 8192, 1, 1, 0}
    },
    {
        {2, 8192, 1, 4096, 0},
        {8192, 8192, 4096, 2048, 1},
        {8192, 16384, 2048, 8192, 0},
        {16384, 16384, 8192, 4096, 1},
        {16384, 16384, 4096, 2048, 1},
        {16384, 16384, 2048, 1, 0}
    },
    {
        {2, 16384, 1, 8192, 0},
        {16384, 16384, 8192, 4096, 1},
        {16384, 16384, 4096, 1, 0}
    },
    {
        {2, 16384, 1, 1, 0}
    },
    {
        {2, 16384, 1, 1, 0}
    },
    {
        {2, 8192, 1, 4096, 0},
        {8192, 8192, 4096, 2048, 1},
        {8192, 16384, 2048, 8192, 0},
        {16384, 16384, 8192, 4096, 1},
        {16384, 16384, 4096, 2048, 1},
        {16384, 32768, 2048, 16384, 0},
        {32768, 32768, 16384, 8192, 1},
        {32768, 32768, 8192, 4096, 1},
        {32768, 32768, 4096, 2048, 1},
        {32768, 32768, 2048, 1, 0}
    },
    {
        {2, 16384, 1, 8192, 0},
        {16384, 16384, 8192, 4096, 1},
        {16384, 32768, 4096, 16384, 0},
        {32768, 32768, 16384, 8192, 1},
        {32768, 32768, 8192, 4096, 1},
        {32768, 32768, 4096, 1, 0}
    },
    {
        {2, 32768, 1, 16384, 0},
        {32768, 32768, 16384, 8192, 1},
        {32768, 32768, 8192, 1, 0}
    },
    {
        {2, 32768, 1, 1, 0}
    },
    {
        {2, 8192, 1, 4096, 0},
        {8192, 8192, 4096, 2048, 1},
        {8192, 16384, 2048, 8192, 0},
        {16384, 16384, 8192, 4096, 1},
        {16384, 16384, 4096, 2048, 1},
        {16384, 32768, 2048, 16384, 0},
        {32768, 32768, 16384, 8192, 1},
        {32768, 32768, 8192, 4096, 1},
        {32768, 32768, 4096, 2048, 1},
        {32768, 65536, 2048, 32768, 0},
        {65536, 65536, 32768, 16384, 1},
        {65536, 65536, 16384, 8192, 1},
        {65536, 65536, 8192, 4096, 1},
        {65536, 65536, 4096, 2048, 1},
        {65536, 65536, 2048, 1, 0}
    },
    {
        {2, 16384, 1, 8192, 0},
        {16384, 16384, 8192, 4096, 1},
        {16384, 32768, 4096, 16384, 0},
        {32768, 32768, 16384, 8192, 1},
        {32768, 32768, 8192, 4096, 1},
        {32768, 65536, 4096, 32768, 0},
        {65536, 65536, 32768, 16384, 1},
        {65536, 65536, 16384, 8192, 1},
        {65536, 65536, 8192, 4096, 1},
        {65536, 65536, 4096, 1, 0}
    },
    {
        {2, 32768, 1, 16384, 0},
        {32768, 32768, 16384, 8192, 1},
        {32768, 65536, 8192, 32768, 0},
        {65536, 65536, 32768, 16384, 1},
        {65536, 65536, 16384, 8192, 1},
        {65536, 65536, 8192, 1, 0}
    },
    {
        {2, 65536, 1, 32768, 0},
        {65536, 65536, 32768, 16384, 1},
        {65536, 65536, 16384, 1, 0}
    },
    {
        {2, 8192, 1, 4096, 0},
        {8192, 8192, 4096, 2048, 1},
        {8192, 16384, 2048, 8192, 0},
        {16384, 16384, 8192, 4096, 1},
        {16384, 16384, 4096, 2048, 1},
        {16384, 32768, 2048, 16384, 0},
        {32768, 32768, 16384, 8192, 1},
        {32768, 32768, 8192, 4096, 1},
        {32768, 32768, 4096, 2048, 1},
        {32768, 65536, 2048, 32768, 0},
        {65536, 65536, 32768, 16384, 1},
        {65536, 65536, 16384, 8192, 1},
        {65536, 65536, 8192, 4096, 1},
        {65536, 65536, 4096, 2048, 1},
        {65536, 131072, 2048, 65536, 0},
        {131072, 131072, 65536, 32768, 1},
        {131072, 131072, 32768, 16384, 1},
        {131072, 131072, 16384, 8192, 1},
        {131072, 131072, 8192, 4096, 1},
        {131072, 131072, 4096, 2048, 1},
        {131072, 131072, 2048, 1, 0}
    },
    {
        {2, 16384, 1, 8192, 0},
        {16384, 16384, 8192, 4096, 1},
        {16384, 32768, 4096, 16384, 0},
        {32768, 32768, 16384, 8192, 1},
        {32768, 32768, 8192, 4096, 1},
        {32768, 65536, 4096, 32768, 0},
        {65536, 65536, 32768, 16384, 1},
        {65536, 65536, 16384, 8192, 1},
        {65536, 65536, 8192, 4096, 1},
        {65536, 131072, 4096, 65536, 0},
        {131072, 131072, 65536, 32768, 1},
        {131072, 131072, 32768, 16384, 1},
        {131072, 131072, 16384, 8192, 1},
        {131072, 131072, 8192, 4096, 1},
        {131072, 131072, 4096, 1, 0}
    },
    {
        {2, 32768, 1, 16384, 0},
        {32768, 32768, 16384, 8192, 1},
        {32768, 65536, 8192, 32768, 0},
        {65536, 65536, 32768, 16384, 1},
        {65536, 65536, 16384, 8192, 1},
        {65536, 131072, 8192, 65536, 0},
        {131072, 131072, 65536, 32768, 1},
        {131072, 131072, 32768, 16384, 1},
        {131072, 131072, 16384, 8192, 1},
        {131072, 131072, 8192, 1, 0}
    },
    {
        {2, 65536, 1, 32768, 0},
        {65536, 65536, 32768, 16384, 1},
        {65536, 131072, 16384, 65536, 0},
        {131072, 131072, 65536, 32768, 1},
        {131072, 131072, 32768, 16384, 1},
        {131072, 131072, 16384, 1, 0}
    }
};

std::vector<std::vector<int>> get_schedule(int log_n, int log_block_width) {
    int coord = (log_n - 12) * 4 + (log_block_width - 12);
    if (coord < 0 || coord >= schedules.size()) {
        throw std::runtime_error("cbm: Invalid kernel parameters for schedule");
    }
    return schedules[coord];
}

